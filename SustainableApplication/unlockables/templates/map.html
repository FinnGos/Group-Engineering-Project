{% load custom_filters %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exeter Map</title>
    <style>
        /* Map Container */
        .map-container {
            position: relative;
            width: 2000px;  /* Adjust based on your game map size */
            height: 1000px;
            background: url('{% static "images/grassbackground.png" %}') no-repeat center;
            background-size: cover;
            border: 2px solid black;
        }

        /* Buildings */
        .building {
            position: absolute;
            width: 200px;  /* Adjust based on image size */
            height: 200px;
        }

        /* Items (Trees, Solar Panels, etc.) */
        .item {
            position: absolute;
            width: 30px;  /* Adjust based on image size */
            height: 30px;
        }
    </style>
</head>
<body>

    <h1>Your Exeter Campus</h1>
    {% if messages %}
    <ul class="messages">
        {% for message in messages %}
            <li class="{{ message.tags }}">{{ message }}</li>
        {% endfor %}
    </ul>
    {% endif %}
    
    <div class="map-container">
        <!-- Buildings -->
        {% for building in buildings %}
            {% if user_buildings|get_item:building.id %}
                <img src="{{ building.image.url }}" class="building" style="top: {{ building.y }}px; left: {{ building.x }}px;">
            {% else %}
                <img src="{{ building.locked_image.url }}" class="building" style="top: {{ building.y }}px; left: {{ building.x }}px;">
            {% endif %}
        {% endfor %}

        <!-- User's Items -->
        {% for item in user_items %}
            <img src="{{ item.item.image.url }}" class="item" style="top: {{ item.y }}px; left: {{ item.x }}px;">
        {% endfor %}

         <!-- Display Rubbish -->
        {% for trash in rubbish %}
            <img 
                src="{{ trash.image.url }}" 
                alt="Rubbish" 
                style="position: absolute; left: {{ trash.x }}px; top: {{ trash.y }}px; width: 40px; height: 40px;" 
            />
            <form action="{% url 'clean_rubbish' trash.id %}" method="post" style="position: absolute; left: {{ trash.x }}px; top: {{ trash.y|add:35 }}px;">
                {% csrf_token %}
                <button type="submit">Clean</button>
            </form>
        {% endfor %}

    </div>

</body>
</html>
